import{a as ae}from"./index-BI7ZPe0T.js";import{r as x,a as d,f as v,D,v as j,j as t,m as h,A as r,H as y,N as pe,g as b,F as R,s as U,M as N,E as B,J as F,B as ee,a0 as te,x as fe,a8 as ge,k as ye,Z as he,b as be,w as ne,a9 as xe,O as we,a6 as _e}from"./@vue-DfHtGlmf.js";import{_ as $e}from"./v-calendar-CxLYP6Dd.js";import{D as T}from"./luxon-C_0L_ju9.js";import"./@vuepic-wgn6EHMi.js";import"./tailwindcss-DTnOEpPf.js";import{s as ke,t as Se,u as se,v as Oe,w as oe,x as Ie,y as Ne}from"./@heroicons-D4l-lLeX.js";import{c as Ce}from"./@vueuse-DYLUAXtt.js";import{Q as De,G as Je,b as Te,c as ze,J as je}from"./@headlessui-CQJB1Lyj.js";import"./pinia-CYGqCAr0.js";import"./vue3-google-signin-D-5jWYq2.js";import"./vue-router-D-0f_54X.js";import"./jose-Deqv1zAq.js";import"./jwt-decode-Bpt2EmM4.js";import"./axios-COvgDtyF.js";import"./@popperjs-DXqTHVUr.js";import"./date-fns-Bg6d8ij9.js";import"./@babel-C82FMKWV.js";import"./picocolors-CBpy9uNM.js";const Ae={class:"relative mt-1"},V={__name:"DropDown",props:{options:Array,currentOption:String,placeholder:String,disabled:{type:Boolean,required:!1,default:!1},shadow:{type:Boolean,required:!1,default:!1}},setup(e){const a=e,s=x(""),i=x(a.currentOption),g=d(()=>s.value===""?a.options:a.options.filter(p=>p?.name.toLowerCase().includes(s.value.toLowerCase())));return(p,u)=>(v(),D(r(je),{as:"div",modelValue:i.value,"onUpdate:modelValue":[u[1]||(u[1]=c=>i.value=c),u[2]||(u[2]=c=>p.$emit("update:currentOption",c))],disabled:e.disabled},{default:j(()=>[t("div",Ae,[h(r(De),{class:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-10 text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",onChange:u[0]||(u[0]=c=>s.value=c.target.value),"display-value":c=>c,placeholder:e.placeholder},null,8,["display-value","placeholder"]),h(r(Je),{class:y(["absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"])},{default:j(()=>[h(r(ke),{class:"h-5 w-5 text-slate-400","aria-hidden":"true"})]),_:1}),h(pe,{"enter-active-class":"transition duration-100 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-75 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:j(()=>[g.value.length>0?(v(),D(r(Te),{key:0,class:y(["absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"])},{default:j(()=>[(v(!0),b(R,null,U(g.value,(c,z)=>(v(),D(r(ze),{key:z,value:c,as:"template"},{default:j(({active:$,selected:k})=>[t("li",{class:y([$?"bg-indigo-600 text-white":"text-slate-900","relative cursor-default select-none py-2 pl-8 pr-4"])},[t("span",{class:y(["block truncate",k&&"font-semibold"])},N(c.name),3),k?(v(),b("span",{key:0,class:y([$?"text-white":"text-indigo-600","absolute inset-y-0 right-0 flex items-center pr-4"])},[h(r(Se),{class:"h-5 w-5","aria-hidden":"true"})],2)):B("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):B("",!0)]),_:1})])]),_:1},8,["modelValue","disabled"]))}},Re="https://api.plethora7.com/api",Pe=(e={})=>Object.entries(e).map(([a,s])=>`${encodeURIComponent(a)}=${encodeURIComponent(JSON.stringify(s))}`).sort().join("&"),qe=({section:e,action:a,query:s})=>`${Re}/${e}/${a}?${s}`;function H(){return{runQuery:async({section:a,action:s,params:i,method:g="GET"})=>{const p=qe({section:a,action:s,query:Pe(i)}),u={method:g,headers:{"Content-Type":"application/json","x-api-key":"c3cada64b1f7fd29c0dce2f04f8752dc358fc60222498c77fd9514269278404ec8cdfd8929d7250b92a28d00ed28f4cd53b3b8f24e17e1acf1c3b8c1ea776db2"}};try{let c=await fetch(p,u);if(c=await c.json(),c.success)return c.data;throw new Error(c)}catch(c){return console.log(JSON.stringify(c.message,null,2)),[]}}}}const K=new WebSocket("wss://api.plethora7.com");K.addEventListener("open",()=>console.log("Connected to websocket"));K.addEventListener("message",({data:e})=>{e=JSON.parse(e),e.type==="goals"&&(G.value=e.content,E({type:"info",title:"There Has Been a Change!",message:"Another user has updated goals.",autoClose:!0,duration:10}))});const{runQuery:le}=H(),{createNotification:E}=ae(),G=x([]),Ue=async()=>{K.send(JSON.stringify({type:"goals",content:G.value}))},re=async()=>{try{const e=await le({section:"goals",action:"getGoals"});G.value=e}catch(e){console.log(e)}};re();const Be=async e=>{try{const a=await le({section:"goals",action:"setGoal",params:e,method:"POST"});await re(),Ue(),E({type:"success",title:"Successfully Saved!",message:`The goal for ${e.sku} (${e.asin}) has been saved.`,autoClose:!0,duration:5})}catch{E({type:"error",title:"Yikes!",message:"Something went wrong saving the goals.",autoClose:!0,duration:5})}};function ie(){const e=x(null),a=x(null),s=({sku:p,asin:u})=>{e.value=p,a.value=u},i=p=>{try{Be(p)}catch(u){console.log(u)}},g=d(()=>G.value.find(p=>p.sku===e.value&&p.asin===a.value)?.goal||0);return{goals:d(()=>G.value),goal:g,setGoalProperties:s,setGoal:i}}const A=x({timezone:"America/Los_Angeles",config:{start:{timeAdjust:"00:00:00"},end:{timeAdjust:"23:59:59.999"}}}),I={last:e=>({start:T.now().setZone(A.value.timezone,{keepLocalTime:!0}).minus({[`${e}s`]:1}).startOf(e).toISO(),end:T.now().setZone(A.value.timezone,{keepLocalTime:!0}).minus({[`${e}s`]:1}).endOf(e).toISO()}),this:e=>({start:T.now().setZone(A.value.timezone,{keepLocalTime:!0}).startOf(e).toISO(),end:T.now().setZone(A.value.timezone,{keepLocalTime:!0}).endOf("day").toISO()})},ue=()=>{const e=[{name:"Weekly",value:"week"},{name:"Monthly",value:"month"}];[...Array(4).keys()].reduce((i,g)=>{const p=T.fromJSDate(new Date,{zone:A.value.timezone,keepLocalTime:!0}).startOf("year").plus({quarter:g}),u=p.endOf("quarter");return i.push({name:`Q${g+1}`,value:JSON.stringify({start:p.toISO(),end:u.toISO()})}),i},[]);const a=[{name:"Today",value:JSON.stringify(I.this("day"))},{name:"Yesterday",value:JSON.stringify(I.last("day"))},{name:"This Week",value:JSON.stringify(I.this("week"))},{name:"Last Week",value:JSON.stringify(I.last("week"))},{name:"This Month",value:JSON.stringify(I.this("month"))},{name:"Last Month",value:JSON.stringify(I.last("month"))},{name:"This Quarter",value:JSON.stringify(I.this("quarter"))},{name:"Last Quarter",value:JSON.stringify(I.last("quarter"))},{name:"This Year",value:JSON.stringify(I.this("year"))},{name:"Last Year",value:JSON.stringify(I.last("year"))}],s=[{name:"No Comparisons",value:null},{name:"Previous Period",value:"period"},{name:"Previous Year",value:"year"}];return{timezone:d(()=>A.value.timezone),config:d(()=>A.value.config),views:e,presets:a,comparisons:s}},W=[{name:"Weekly",value:"week",intervalsPerYear:52},{name:"Monthly",value:"month",intervalsPerYear:12}],M=x(W.find(e=>e.value==="month")),Ge=()=>{localStorage.getItem("timeInterval")!==null&&(M.value=JSON.parse(localStorage.getItem("timeInterval")))};Ge();const Le=()=>localStorage.setItem("timeInterval",JSON.stringify(M.value));function X(){const e=a=>{try{M.value=W.find(s=>s.value===a),Le()}catch(s){console.log(s)}};return{timeInterval:d(()=>M.value),timeIntervalOptions:d(()=>W),setTimeInterval:e}}const Me=["onClick"],Qe={class:"relative flex flex-grow items-stretch"},Ye=["value"],Fe={class:"relative flex flex-grow items-stretch"},Ve=["value"],Ee={class:"flex items-stretch justify-between space-x-2 border-t border-gray-100 px-2 py-4"},We={class:"flex items-stretch justify-end space-x-2 px-2 pb-4"},Ze=["onClick"],He=["disabled"],Ke={__name:"DatePicker",props:{initialRange:Object,view:String,disabled:{type:Boolean,required:!1,default:!1}},emits:["update","update:initialRange","update:view","update:comparison"],setup(e,{emit:a}){const s=e,{timezone:i,config:g,views:p,presets:u}=ue(),{setTimeInterval:c,timeIntervalOptions:z,timeInterval:$}=X(),k=x(s.initialRange),C=x(null),_=x(null),S=O=>{O={...{mode:"select",value:""},...O};let{mode:l,value:n}=O;n=typeof n=="object"?n:JSON.parse(n),l==="preset"&&_.value.move(n.start),n=Object.keys(n).reduce((m,f)=>({...m,[f]:T.fromJSDate(new Date(n[f])).setZone(i.value).toISO()}),{}),C.value=JSON.stringify(n),k.value=n},J=()=>{a("update:initialRange",k.value)},P=()=>{S({mode:"select",value:s.initialRange}),_.value.hidePopover()},w={highlight:{start:{fillMode:"solid",contentClass:"bg-indigo-500 hover:bg-indigo-500 focus:bg-indigo-500"},base:{class:"bg-indigo-100"},end:{fillMode:"solid",contentClass:"bg-indigo-500 hover:bg-indigo-500 focus:bg-indigo-500"}}};return(O,o)=>(v(),D(r($e),{"model-value":k.value,"onUpdate:modelValue":o[3]||(o[3]=l=>S({mode:"select",value:l})),"model-config":r(g),"is-range":"",timezone:r(i),ref_key:"calendar",ref:_,columns:2,transition:"slide-h","max-date":new Date,popover:{keepVisibleOnInput:!0,visibility:"click"},"select-attribute":w,"drag-attribute":w},{default:j(({inputValue:l,inputEvents:n,togglePopover:m})=>[t("div",{class:"flex items-stretch justify-center text-slate-400 focus-within:text-slate-500",onClick:F(f=>m(),["stop"])},[t("div",Qe,[h(r(se),{class:"absolute inset-y-0 left-0 z-10 ml-2 mr-6 h-full w-4 text-slate-400"}),t("input",ee({value:l.start},te(n.start,!0),{class:["appearance-none rounded-md border border-transparent py-2 pl-8 pr-2 text-center focus:outline-none sm:text-sm","shadow-md"]}),null,16,Ye)]),h(r(Oe),{class:"mx-2 h-auto w-4 flex-grow-0 align-middle"}),t("div",Fe,[h(r(se),{class:"absolute inset-y-0 left-0 z-10 ml-2 mr-6 h-full w-4 text-slate-400"}),t("input",ee({value:l.end},te(n.end,!0),{class:["appearance-none rounded-md border border-transparent py-2 pl-8 pr-2 text-center focus:outline-none sm:text-sm","shadow-md"]}),null,16,Ve)])],8,Me)]),footer:j(()=>[t("div",Ee,[h(V,{options:r(u),"current-option":C.value,"onUpdate:currentOption":[o[0]||(o[0]=l=>C.value=l),o[1]||(o[1]=l=>S({mode:"preset",value:l}))],placeholder:"Custom Range",position:"left-0",width:"w-full",class:"w-full rounded-md border border-gray-100"},null,8,["options","current-option"]),h(V,{"current-option":r($).value,"onUpdate:currentOption":[o[2]||(o[2]=l=>r($).value=l),r(c)],options:r(z),position:"left-0",width:"w-full",class:"w-full rounded-md border border-gray-100"},null,8,["current-option","options","onUpdate:currentOption"])]),t("div",We,[t("button",{class:y(["rounded border border-transparent px-4 py-2 text-slate-500 focus:border-gray-300 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"]),onClick:F(P,["stop"])}," Cancel ",8,Ze),t("button",{disabled:e.disabled,class:y(["rounded border border-transparent px-4 py-2 font-medium text-indigo-600 transition hover:bg-indigo-600 hover:text-white focus:border-indigo-600 focus:outline-none","disabled:cursor-not-allowed disabled:opacity-50"]),onClick:J}," Apply ",8,He)])]),_:1},8,["model-value","model-config","timezone","max-date"]))}},L={currency:e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),number:e=>new Intl.NumberFormat("en-US").format(e)},Xe=t("header",{class:"h-12 border-b border-gray-300 bg-slate-50"},null,-1),et={class:"flex w-1/4 items-center space-x-4 py-4"},tt={class:"h-24 w-24 rounded-md bg-slate-200 p-2"},st=ge('<div class="flex-grow space-y-2"><div class="grid w-full grid-cols-4 items-center gap-2"><div class="col-span-4 h-3 rounded-full bg-slate-200"></div></div><div class="grid w-full grid-cols-4 items-center gap-2"><div class="col-span-2 h-3 rounded-full bg-slate-200"></div><div class="col-span-1 h-3 rounded-full bg-slate-200"></div></div></div>',1),at={class:"ml-8 flex flex-grow flex-col justify-center py-4"},nt={class:"grid grid-cols-5 items-center gap-2"},ot={class:"flex flex-col items-center space-y-3"},lt=t("div",{class:"flex space-x-3"},[t("div",{class:"h-3 w-3 rounded-full bg-slate-200"}),t("div",{class:"h-3 w-12 rounded-full bg-slate-200"})],-1),rt=t("div",{class:"h-3 w-24 rounded-full bg-slate-200"},null,-1),it=[lt,rt],ut={__name:"SkuTableSkeleton",props:{pulse:{type:Boolean,default:!0}},setup(e){return(a,s)=>(v(),b(R,null,[Xe,t("div",{class:y([{"animate-pulse":e.pulse},"mx-auto flex w-full items-center justify-between rounded-md bg-white py-3 px-4 transition sm:px-6"])},[fe(a.$slots,"default",{},()=>[t("section",et,[t("div",tt,[h(r(oe),{class:"text-slate-300"})]),st]),t("section",at,[t("div",nt,[(v(),b(R,null,U(5,i=>t("div",ot,it)),64))])])])],2)],64))}},{runQuery:ct}=H(),{createNotification:Q,removeNotification:dt}=ae(),ce=x([]),Z=ye({loading:!1}),mt=async e=>{Z.loading=!0;try{let{id:a}=Q({type:"info",title:"Loading Sales Data",message:"Please do not refresh the page.",autoClose:!1});const s=await ct({section:"sales",action:"getSalesByPeriod",params:e});ce.value=s,dt(a),Q({type:"success",title:"Successfully Loaded!",message:"The sales data has successfully loaded.",autoClose:!0,duration:5})}catch(a){console.log(a),Q({type:"error",title:"Yikes!",message:`Something went wrong getting the sales data:
      ${a.message}`,autoClose:!0,duration:5})}finally{Z.loading=!1}};function de(){const e=a=>mt(a);return{salesData:d(()=>ce.value),getSalesData:e,...he(Z)}}const{runQuery:vt}=H(),{salesData:pt}=de(),me=d(()=>{let e=pt.value.map(s=>s?.asin);return yt({array:e,size:20})}),ft=Ce(async()=>{let e={};for(const[a,s]of me.value.entries())e={...e,...await gt({identifiers:s,includedData:["images"]})};return e},{lazy:!0}),gt=async e=>{try{return(await vt({section:"amazon/products",action:"getCatalogItems",params:e})).reduce((s,i)=>(s[i.asin]={imgUrl:i?.images?.[0]?.images?.[0]?.link},s),{})}catch(a){console.log(a)}},yt=({array:e,size:a=20})=>{let s=[...Array.from(new Set(e))];return s=s.reduce((i,g,p)=>{const u=Math.floor(p/a);return i[u]=[].concat(i[u]||[],g),i},[]),s};function ht(){return{amazonCatalog:d(()=>ft.value),catalogQueue:d(()=>me.value)}}const{amazonCatalog:bt}=ht();function xt(){const e=x(null),a=d(()=>bt?.value?.[e.value]?.imgUrl);return{setProductAsin:i=>e.value=i,productImage:a}}const wt={class:y(["w-auto whitespace-nowrap px-3 py-4 text-center text-sm text-slate-700"])},_t={class:"space-y-2"},$t={class:"group/units flex flex-grow flex-wrap items-center justify-center"},kt={class:"flex items-center space-x-1"},St={class:"flex flex-grow flex-wrap items-baseline justify-center"},Ot={class:"text-xs text-slate-500"},Y={__name:"SkuColumn",props:{current:Object,previous:{type:Object,required:!1,default:void 0},goal:{type:[Number,String],required:!1,default:void 0},best:{type:Boolean,required:!1,default:!1}},setup(e){const a=e,s=d(()=>!!(a.best||a.goal&&a.current.quantity<a.goal));return(i,g)=>(v(),b("td",wt,[t("div",_t,[t("div",$t,[t("div",kt,[s.value?(v(),b("span",{key:0,class:y(["h-1.5 w-1.5 items-center rounded-full text-lg transition-all",e.best?"bg-indigo-400":e.goal&&e.current.quantity<e.goal?e.previous&&e.previous.quantity<e.goal?"bg-red-400":"bg-yellow-400":"hidden"])},null,2)):B("",!0),t("span",null,N(r(L).number(e.current.quantity)),1)])]),t("div",St,[t("div",Ot,N(r(L).currency(e.current.revenue)),1)])])]))}},It={class:"group mx-1 inline-flex items-center rounded-full border border-slate-200 px-2 py-1 text-xs text-slate-700 transition first:ml-0 last:mr-0"},Nt=t("span",{class:"inline-block h-1.5 w-1.5 rounded-full bg-green-400","aria-hidden":"true"},null,-1),Ct={class:"ml-1 font-medium"},Dt={class:"-ml-8 flex opacity-0 transition-all group-hover:ml-1 group-hover:space-x-1 group-hover:opacity-100"},Jt=["href"],Tt={__name:"TagElement",props:{value:String,link:String},setup(e){const a=async s=>navigator.clipboard.writeText(s);return(s,i)=>(v(),b("span",It,[Nt,t("span",Ct,N(e.value),1),t("span",Dt,[e.link?(v(),b("a",{key:0,href:e.link,target:"_blank"},[h(r(Ie),{class:"h-4 w-4 text-slate-400 transition hover:text-slate-700 active:rotate-6 active:scale-125"})],8,Jt)):B("",!0),t("a",{href:"#",onClick:i[0]||(i[0]=F(g=>a(e.value),["stop"]))},[h(r(Ne),{class:"h-4 w-4 text-slate-400 transition hover:text-slate-700 active:rotate-6 active:scale-125"})])])]))}},zt={class:"flex items-center"},jt={class:"h-24 w-24 flex-shrink-0"},At={class:"h-24 w-24 overflow-hidden rounded-md bg-white p-2 shadow ring-1 ring-black ring-opacity-[.02]"},Rt=["src"],Pt={class:"ml-4"},qt={class:"font-medium text-slate-900"},Ut={class:y(["w-auto whitespace-nowrap px-3 py-4 text-center text-sm text-slate-500"])},Bt={class:"inline-flex w-full max-w-md rounded-md shadow-sm"},Gt=["name","id"],Lt={class:"flex flex-wrap justify-center space-x-2"},Mt={class:"text-xs"},Qt={class:"font-semibold text-slate-900"},Yt={class:"text-xs"},Ft={class:"font-semibold text-slate-900"},Vt=t("span",null," per year",-1),Et={__name:"SkuRow",props:{dates:Array,row:Object,index:Number,tableScrolled:Boolean},emits:["updateRevenue"],setup(e,{emit:a}){const s=e,{setGoal:i,setGoalProperties:g,goal:p}=ie(),{timeInterval:u}=X(),{setProductAsin:c,productImage:z}=xt();c(s.row.asin),g({sku:s.row.sku,asin:s.row.asin});const $=z,k=d(()=>s.dates),C=d(()=>s.row.dates),_=d(()=>k.value.map(m=>C.value.find(f=>f[u.value.value]===m[u.value.value]&&f.year===m.year)||{...m,revenue:0,quantity:0})),S=d(()=>(_.value.reduce((m,f)=>m+=f.quantity,0)/_.value.length).toFixed(1)),J=d(()=>(C.value.reduce((m,f)=>m+=f.revenue/f.quantity,0)/C.value.length).toFixed(2)),P=d(()=>J.value*S.value),w=x(0),O=d(()=>w.value*u.value.intervalsPerYear*J.value),o=d(()=>w.value*J.value),l=d(()=>({quantity:S.value,revenue:P.value})),n=d(()=>_.value.reduce((m,f)=>m.quantity>f.quantity?m:f));return be(O,(m,f)=>{a("updateRevenue",m-(f||0))},{immediate:!0}),ne(()=>{w.value=(p.value/u.value.intervalsPerYear).toFixed(0)}),xe(()=>{a("updateRevenue",-O.value)}),(m,f)=>(v(),b("tr",{class:y([e.index%2===0?void 0:"bg-slate-50","divide-x divide-gray-100"])},[t("td",{class:y([e.index%2===0?"bg-white":"bg-slate-50","sticky left-0 z-0 whitespace-nowrap py-4 pl-4 pr-3 text-sm transition-all sm:pl-6",{"border-r-4":e.tableScrolled}])},[t("div",zt,[t("div",jt,[t("div",At,[r($)?(v(),b("img",{key:0,class:"h-20 w-20 object-contain",src:r($),alt:""},null,8,Rt)):(v(),D(r(oe),{key:1,class:"h-20 w-20 animate-pulse text-slate-200"}))])]),t("div",Pt,[t("div",qt,N(e.row.sku),1),t("div",null,[e.row.asin?(v(),D(Tt,{key:0,class:y(["text-xs"]),value:e.row.asin,link:`https://sellercentral.amazon.com/skucentral?mSku=${e.row.sku}&ref=myi_skuc`},null,8,["value","link"])):B("",!0)])])])],2),(v(!0),b(R,null,U(_.value,(q,ve)=>(v(),D(Y,{current:q,previous:_.value[ve-1],goal:w.value||S.value,best:q===n.value},null,8,["current","previous","goal","best"]))),256)),h(Y,{current:n.value,best:!0},null,8,["current"]),h(Y,{current:l.value},null,8,["current"]),t("td",Ut,[t("div",Bt,[we(t("input",{"onUpdate:modelValue":f[0]||(f[0]=q=>w.value=q),type:"number",name:`${e.row.asin}_goal`,id:`${e.row.asin}_goal`,class:"flex-grow rounded-l-md border-gray-300 text-center focus:z-10 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 sm:text-sm"},null,8,Gt),[[_e,w.value]]),t("button",{type:"button",class:"-ml-px inline-flex items-center whitespace-nowrap rounded-r-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium leading-4 text-slate-700 hover:bg-slate-50 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:cursor-not-allowed disabled:opacity-30",onClick:f[1]||(f[1]=q=>r(i)({sku:e.row.sku,asin:e.row.asin,goal:w.value*r(u).intervalsPerYear}))}," Set Goal ")]),t("div",Lt,[t("div",Mt,[t("span",Qt,N(r(L).currency(o.value)),1),t("span",null," per "+N(r(u).value),1)]),t("div",Yt,[t("span",Ft,N(r(L).currency(O.value)),1),Vt])])])],2))}},Wt={class:"flex h-full w-full flex-col"},Zt={class:"relative z-20 flex w-full items-center justify-between space-x-4"},Ht={class:"flex w-1/2 items-center justify-start space-x-4"},Kt=t("h1",{class:"text-lg font-medium leading-6 text-slate-900"},"Brand Revenue Goals",-1),Xt={class:y(["w-72"])},es={class:"text-lg font-medium leading-6 text-slate-900"},ts={key:0,class:"relative min-w-full table-auto border-separate border-spacing-0 divide-y divide-slate-300 ring-1 ring-black ring-opacity-5"},ss={class:"bg-slate-50"},as={class:"divide-x divide-slate-300"},ns=t("th",{scope:"col",class:y(["px-3 py-3.5 text-center text-sm font-semibold text-slate-900","border-b border-slate-300","sticky top-0 bg-slate-50"])}," Best ",-1),os=t("th",{scope:"col",class:y(["px-3 py-3.5 text-center text-sm font-semibold text-slate-900","border-b border-slate-300","sticky top-0 bg-slate-50"])}," Average ",-1),ls=t("th",{scope:"col",class:y(["px-3 py-3.5 text-center text-sm font-semibold text-slate-900","border-b border-slate-300","sticky top-0 bg-slate-50"])}," Goal ",-1),rs={class:"divide-y divide-slate-200 bg-white"},is={__name:"SkuTable",setup(e){const a=x(null),{timeInterval:s}=X(),{getSalesData:i,salesData:g,loading:p}=de(),{presets:u}=ue(),c=x(JSON.parse(u.find(o=>o.name==="This Year").value)),z=({interval:o,year:l})=>{o===0&&(o=52,l=--l);const n=T.fromObject({weekYear:l,weekNumber:o});return`${n.startOf("week").toFormat("MM/dd/yy")}-${n.endOf("week").toFormat("MM/dd/yy")}`},$=({interval:o,year:l})=>`${T.fromObject({month:o,year:l}).startOf("month").toFormat("MMM yyyy")}`,k=({interval:o,year:l})=>s.value.value==="week"?z({interval:o,year:l}):$({interval:o,year:l}),C=d(()=>[{name:"All Brands",value:null},...Array.from(new Set(g.value.map(o=>JSON.stringify({name:o.brand,value:o.brand}))),JSON.parse)]),_=d(()=>g.value.filter(o=>o.brand.includes(a.value||""))),S=d(()=>Array.from(new Set(_.value.reduce((o,l)=>o.concat(l.dates.map(n=>({[s.value.value]:n[s.value.value],year:n.year}))),[]).map(JSON.stringify)),JSON.parse).sort((o,l)=>{const n=m=>`${m.year}${m[s.value.value].toString().padStart(2,0)}`;return n(o)-n(l)}));d(()=>_.value.reduce((o,l)=>(o+=l.dates.map(n=>n.revenue).reduce((n,m)=>n+m),o),0));const J=x(0),P=o=>J.value+=o,w=x(!1),O=o=>w.value=o.target.scrollLeft>0;return ne(()=>{console.log(`Running getSalesData with params: {range: ${c.value}, view: ${s.value.value}}`),i({range:c.value,view:s.value.value})}),(o,l)=>(v(),b("div",Wt,[t("div",Zt,[t("div",Ht,[Kt,t("div",Xt,[h(V,{shadow:"","current-option":a.value,"onUpdate:currentOption":l[0]||(l[0]=n=>a.value=n),options:C.value,placeholder:"Filter by brand",disabled:r(p)},null,8,["current-option","options","disabled"])]),t("h1",es,N(r(L).currency(J.value)),1)]),h(Ke,{"initial-range":c.value,"onUpdate:initialRange":[l[1]||(l[1]=n=>c.value=n),l[3]||(l[3]=n=>c.value=n)],view:r(s).value,"onUpdate:view":l[2]||(l[2]=n=>r(s).value=n),disabled:r(p)},null,8,["initial-range","view","disabled"])]),t("div",{class:"relative mt-6 overflow-auto bg-white shadow ring-1 ring-black ring-opacity-5 md:rounded-lg",onScroll:O},[r(p)?(v(),D(ut,{key:1})):(v(),b("table",ts,[t("thead",ss,[t("tr",as,[t("th",{scope:"col",class:y(["sticky left-0 top-0 z-10 whitespace-nowrap border-slate-300 bg-slate-50 py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-slate-900 transition-all sm:pl-6","border-b border-slate-300",{"border-r-4":w.value}])}," SKU ",2),(v(!0),b(R,null,U(S.value,({[r(s).value]:n,year:m})=>(v(),b("th",{scope:"col",class:y(["whitespace-nowrap px-3 py-3.5 text-center text-sm font-semibold text-slate-900","border-b border-slate-300","sticky top-0 bg-slate-50"]),key:n},N(k({interval:n,year:m})),1))),128)),ns,os,ls])]),t("tbody",rs,[(v(!0),b(R,null,U(_.value,(n,m)=>(v(),D(Et,{dates:S.value,row:n,index:m,key:`${n.asin}_${n.sku}`,onUpdateRevenue:P,tableScrolled:w.value},null,8,["dates","row","index","tableScrolled"]))),128))])]))],32)]))}},us={class:"flex h-screen flex-col px-8 pt-24 pb-8"},Cs={__name:"GoalsView",setup(e){return ie(),(a,s)=>(v(),b("div",us,[h(is)]))}};export{Cs as default};
